(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[478],{2898:function(e,t,r){"use strict";r.d(t,{Z:function(){return createLucideIcon}});var s=r(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),createLucideIcon=(e,t)=>{let r=(0,s.forwardRef)(({color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:l,children:u,...o},c)=>(0,s.createElement)("svg",{ref:c,...n,width:a,height:a,stroke:r,strokeWidth:l?24*Number(i)/Number(a):i,className:`lucide lucide-${toKebabCase(e)}`,...o},[...t.map(([e,t])=>(0,s.createElement)(e,t)),...(Array.isArray(u)?u:[u])||[]]));return r.displayName=`${e}`,r}},2442:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(2898);let n=(0,s.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},8963:function(e,t,r){Promise.resolve().then(r.bind(r,9358))},9358:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return PaymentSuccessPage}});var s=r(7437),n=r(2265),a=r(4033),i=r(2442),l=r(2899),u=r(5093);function PaymentSuccessPage(){let e=(0,a.useSearchParams)(),t=(0,a.useRouter)(),{user:r}=(0,u.useAuth)(),[o,c]=(0,n.useState)(!0),[d,h]=(0,n.useState)(null);(0,n.useEffect)(()=>{handlePaymentSuccess()},[]);let handlePaymentSuccess=async()=>{try{let s=e.get("order_no"),n=e.get("payapp_order_id");if(!s||!r)throw Error("잘못된 접근입니다.");let{error:a}=await l.OQ.from("users").update({user_type:"student",payment_status:"paid",last_payment_date:new Date().toISOString()}).eq("id",r.id);if(a)throw a;let{error:i}=await l.OQ.from("payments").insert({user_id:r.id,order_id:s,payapp_order_id:n,amount:29900,status:"completed",created_at:new Date().toISOString()});i&&console.error("결제 기록 저장 실패:",i),setTimeout(()=>{t.push("/lectures")},3e3)}catch(e){h(e.message)}finally{c(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-black flex items-center justify-center px-4",children:(0,s.jsx)("div",{className:"max-w-md w-full",children:(0,s.jsx)("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-8 text-center",children:o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-yellow-400/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-400"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"결제 처리 중..."}),(0,s.jsx)("p",{className:"text-gray-400",children:"잠시만 기다려주세요."})]}):d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)("span",{className:"text-red-400 text-3xl",children:"!"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"결제 처리 실패"}),(0,s.jsx)("p",{className:"text-red-400 mb-6",children:d}),(0,s.jsx)("button",{onClick:()=>t.push("/"),className:"px-6 py-3 bg-yellow-400 text-black font-semibold rounded-lg hover:bg-yellow-300 transition-colors",children:"홈으로 돌아가기"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)(i.Z,{className:"text-green-400",size:32})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"결제 완료!"}),(0,s.jsxs)("p",{className:"text-gray-400 mb-6",children:["프로 플랜 가입이 완료되었습니다.",(0,s.jsx)("br",{}),"모든 강의를 자유롭게 수강하실 수 있습니다."]}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"잠시 후 강의 페이지로 이동합니다..."})]})})})})}},5093:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var s=r(7437),n=r(2265),a=r(2899),i=r(4033);let l=(0,n.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[r,u]=(0,n.useState)(null),[o,c]=(0,n.useState)(null),[d,h]=(0,n.useState)(!0),m=(0,i.useRouter)(),fetchUserProfile=async e=>{let{data:t,error:r}=await a.OQ.from("profiles").select("*").eq("id",e).single();t&&c(t)};(0,n.useEffect)(()=>{a.OQ.auth.getSession().then(e=>{var t;let{data:{session:r}}=e;u(null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null),(null==r?void 0:r.user)&&fetchUserProfile(r.user.id),h(!1)});let{data:{subscription:e}}=a.OQ.auth.onAuthStateChange(async(e,t)=>{var r;u(null!==(r=null==t?void 0:t.user)&&void 0!==r?r:null),(null==t?void 0:t.user)?await fetchUserProfile(t.user.id):c(null)});return()=>e.unsubscribe()},[]);let signIn=async(e,t)=>{let{data:r,error:s}=await a.OQ.auth.signInWithPassword({email:e,password:t});return r.user&&await fetchUserProfile(r.user.id),{error:s}},signUp=async(e,t,r)=>{let{data:s,error:n}=await a.OQ.auth.signUp({email:e,password:t,options:{data:r}});if(s.user&&!n){let{error:t}=await a.OQ.from("profiles").insert({id:s.user.id,email:s.user.email,name:(null==r?void 0:r.name)||e.split("@")[0],phone:(null==r?void 0:r.phone)||"",role:"user",created_at:new Date().toISOString()});t&&console.error("프로필 생성 오류:",t)}return{error:n}},signOut=async()=>{await a.OQ.auth.signOut(),c(null),m.push("/")},f=(null==o?void 0:o.role)==="admin";return(0,s.jsx)(l.Provider,{value:{user:r,userProfile:o,loading:d,signIn,signUp,signOut,isAdmin:f},children:t})}let useAuth=()=>{let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2899:function(e,t,r){"use strict";r.d(t,{OQ:function(){return n}});var s=r(1492);let n=(0,s.eI)("https://wpzvocfgfwvsxmpckdnu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndwenZvY2ZnZnd2c3htcGNrZG51Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2Njc4NTIsImV4cCI6MjA2ODI0Mzg1Mn0.LlO3iM55sbzXexcCExkDsSH448J2Z-NJUT1aZQCdck8")},622:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s=r(2265),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var s,a={},o=null,c=null;for(s in void 0!==r&&(o=""+r),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(c=t.ref),t)i.call(t,s)&&!u.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===a[s]&&(a[s]=t[s]);return{$$typeof:n,type:e,key:o,ref:c,props:a,_owner:l.current}}t.Fragment=a,t.jsx=q,t.jsxs=q},7437:function(e,t,r){"use strict";e.exports=r(622)}},function(e){e.O(0,[815,971,472,744],function(){return e(e.s=8963)}),_N_E=e.O()}]);