"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[450],{2450:function(e,t,l){l.d(t,{Z:function(){return Header}});var r=l(7437),s=l(2265),a=l(4033),n=l(6691),i=l.n(n),o=l(7972),c=l(5883),d=l(2549),u=l(8004),h=l(5093),m=l(2442),x=l(4931),p=l.n(x),g=l(2601);let b={secretKey:g.env.PAYAPP_SECRET_KEY||"2m/tdA5GmmwTLP/KWo9V7e1DPJnCCRVaOgT+oqg6zaM=",value:g.env.PAYAPP_VALUE||"2m/tdA5GmmwTLP/KWo9V7c0BU4QO/tDrbfcHeaukANY=",userCode:"BA0209",storeId:"dduksanglab",testMode:!0},y={basic:{id:"basic",name:"베이직 플랜",price:9900,description:"기본 강의 접근",features:["기본 강의 무제한 시청","커뮤니티 접근","기본 지원"]},pro:{id:"pro",name:"프로 플랜",price:29900,description:"전체 강의 + 프리미엄 기능",features:["모든 강의 무제한 시청","커뮤니티 프리미엄 접근","1:1 멘토링 월 1회","SaaS 홍보 기회","우선 지원"]},enterprise:{id:"enterprise",name:"엔터프라이즈",price:99900,description:"팀/기업용 맞춤 플랜",features:["모든 프로 플랜 기능","팀 계정 관리","전용 멘토링","맞춤형 교육 과정","전용 지원"]}};function generatePayAppSignature(e){let t=Object.keys(e).sort(),l=t.map(t=>"".concat(t,"=").concat(e[t])).join("&"),r=l+b.value,s=p().createHmac("sha256",b.secretKey).update(r).digest("base64");return s}function generatePayAppUrl(e){let t={cmd:"pay",user_code:b.userCode,store_id:b.storeId,item_name:y[e.planId].name,amount:e.amount,order_no:e.orderId,user_name:e.userName,user_email:e.userEmail,return_url:"".concat("http://localhost:3000","/payment/success"),cancel_url:"".concat("http://localhost:3000","/payment/cancel"),noti_url:"".concat("http://localhost:3000","/api/payment/webhook"),test_mode:b.testMode?"Y":"N",timestamp:Math.floor(Date.now()/1e3)},l=generatePayAppSignature(t),r=new URLSearchParams({...Object.entries(t).reduce((e,t)=>{let[l,r]=t;return{...e,[l]:String(r)}},{}),signature:l}).toString();return"https://api.payapp.kr/v1/payment?".concat(r)}function generateOrderId(){let e=Date.now(),t=Math.random().toString(36).substring(2,9);return"DDK-".concat(e,"-").concat(t).toUpperCase()}function AuthModal(e){let{isOpen:t,onClose:l,initialMode:a="signin"}=e,[n,i]=(0,s.useState)(a),[o,c]=(0,s.useState)(""),[u,x]=(0,s.useState)(""),[p,g]=(0,s.useState)(""),[b,f]=(0,s.useState)("basic"),[v,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!1),[k,C]=(0,s.useState)(null),{signIn:S,signUp:A}=(0,h.useAuth)(),handleSubmit=async e=>{e.preventDefault(),N(!0),C(null);try{if("signin"===n){let{error:e}=await S(o,u);if(e)throw e;l()}else{if(!v){w(!0),N(!1);return}let{error:e}=await A(o,u,{name:p,selected_plan:b});if(e)throw e;{let e=generateOrderId(),t=y[b],r=generatePayAppUrl({orderId:e,userName:p,userEmail:o,planId:b,amount:t.price});window.open(r,"payapp_payment","width=800,height=600"),l()}}}catch(e){C(e.message||"오류가 발생했습니다."),N(!1)}};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg p-8 max-w-md w-full mx-4 relative",children:[(0,r.jsx)("button",{onClick:l,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:(0,r.jsx)(d.Z,{className:"w-6 h-6"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"signin"===n?"로그인":v?"플랜 선택":"회원가입"}),(0,r.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:["signup"!==n||v?"signup"===n&&v?(0,r.jsx)("div",{className:"space-y-4",children:Object.entries(y).map(e=>{let[t,l]=e;return(0,r.jsx)("div",{onClick:()=>f(t),className:"border rounded-lg p-4 cursor-pointer transition-all ".concat(b===t?"border-yellow-400 bg-yellow-400/10":"border-gray-700 hover:border-gray-600"),children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:l.name}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:l.description}),(0,r.jsx)("div",{className:"mt-3 space-y-1",children:l.features.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-300",children:[(0,r.jsx)(m.Z,{className:"w-4 h-4 text-green-400 mr-2"}),(0,r.jsx)("span",{children:e})]},t))})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-yellow-400",children:["₩",l.price.toLocaleString()]}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"/월"})]})]})},t)})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-1",children:"이메일"}),(0,r.jsx)("input",{id:"email",type:"email",value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",placeholder:"example@email.com",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:"비밀번호"}),(0,r.jsx)("input",{id:"password",type:"password",value:u,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",placeholder:"••••••••",required:!0,minLength:6})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300 mb-1",children:"이름"}),(0,r.jsx)("input",{id:"name",type:"text",value:p,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",placeholder:"홍길동",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-1",children:"이메일"}),(0,r.jsx)("input",{id:"email",type:"email",value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",placeholder:"example@email.com",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:"비밀번호"}),(0,r.jsx)("input",{id:"password",type:"password",value:u,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-yellow-400",placeholder:"••••••••",required:!0,minLength:6})]})]}),k&&(0,r.jsx)("div",{className:"text-red-400 text-sm bg-red-900/20 border border-red-800 rounded-lg p-3",children:k}),(0,r.jsx)("button",{type:"submit",disabled:j,className:"w-full bg-yellow-400 text-black font-semibold py-3 rounded-lg hover:bg-yellow-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:j?"처리 중...":"signin"===n?"로그인":v?"결제하기":"다음"})]}),(0,r.jsx)("div",{className:"mt-6 text-center text-gray-400",children:"signin"===n?(0,r.jsxs)(r.Fragment,{children:["계정이 없으신가요?"," ",(0,r.jsx)("button",{onClick:()=>{i("signup"),C(null),w(!1)},className:"text-yellow-400 hover:underline",children:"회원가입"})]}):(0,r.jsxs)(r.Fragment,{children:["이미 계정이 있으신가요?"," ",(0,r.jsx)("button",{onClick:()=>{i("signin"),C(null),w(!1)},className:"text-yellow-400 hover:underline",children:"로그인"})]})})]})}):null}function Header(e){var t,l;let{currentPage:n="home"}=e,[m,x]=(0,s.useState)(!1),[p,g]=(0,s.useState)(!1),[b,y]=(0,s.useState)(!1),[f,v]=(0,s.useState)("signin"),w=(0,a.useRouter)(),{user:j,userProfile:N,signOut:k,isAdmin:C}=(0,h.useAuth)(),S=[{id:"ai-trends",label:"AI 트렌드",href:"/ai-trends"},{id:"saas",label:"SaaS 쇼케이스",href:"/saas"},{id:"community",label:"커뮤니티",href:"/community"},{id:"lectures",label:"강의",href:"/lectures"},...C?[{id:"admin",label:"관리",href:"/admin"}]:[]],handleSignOut=async()=>{await k(),g(!1)},handleAuthClick=e=>{v(e),y(!0)};return(0,r.jsxs)("header",{className:"fixed top-0 left-0 right-0 z-50 bg-black/80 backdrop-blur-md border-b border-yellow-500/20",children:[(0,r.jsxs)("div",{className:"container mx-auto px-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("a",{href:"/",className:"block",children:(0,r.jsx)("div",{className:"relative w-12 h-12",children:(0,r.jsx)(i(),{src:"/images/떡상연구소_로고-removebg-preview.png",alt:"떡상연구소 로고",fill:!0,className:"object-contain",priority:!0})})})}),(0,r.jsx)("nav",{className:"hidden md:flex space-x-6",children:S.map(e=>(0,r.jsx)("a",{href:e.href,className:"font-medium transition-colors ".concat(n===e.id?"text-yellow-400":"text-gray-300 hover:text-yellow-400"),children:e.label},e.id))}),(0,r.jsx)("div",{className:"hidden md:flex items-center space-x-3",children:j?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>g(!p),className:"flex items-center space-x-2 text-gray-300 hover:text-yellow-400 transition-colors",children:[(0,r.jsx)(o.Z,{size:20}),(0,r.jsx)("span",{children:(null==N?void 0:N.name)||(null===(t=j.email)||void 0===t?void 0:t.split("@")[0])||"사용자"})]}),p&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-gray-900 border border-yellow-500/20 rounded-lg shadow-xl",children:(0,r.jsxs)("div",{className:"py-2",children:[(0,r.jsx)("div",{className:"px-4 py-2 text-sm text-gray-400 border-b border-gray-800",children:(null==N?void 0:N.role)==="admin"?"관리자":"일반회원"}),(0,r.jsx)("button",{onClick:()=>w.push("/mypage"),className:"w-full px-4 py-2 text-left text-gray-300 hover:bg-gray-800 hover:text-yellow-400 transition-colors",children:"마이페이지"}),(0,r.jsx)("button",{onClick:()=>w.push("/settings"),className:"w-full px-4 py-2 text-left text-gray-300 hover:bg-gray-800 hover:text-yellow-400 transition-colors",children:"설정"}),(0,r.jsxs)("button",{onClick:handleSignOut,className:"w-full px-4 py-2 text-left text-gray-300 hover:bg-gray-800 hover:text-red-400 transition-colors flex items-center space-x-2",children:[(0,r.jsx)(c.Z,{size:16}),(0,r.jsx)("span",{children:"로그아웃"})]})]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>handleAuthClick("signin"),className:"px-4 py-2 text-yellow-400 border border-yellow-400 rounded hover:bg-yellow-400 hover:text-black transition-colors",children:"로그인"}),(0,r.jsx)("button",{onClick:()=>handleAuthClick("signup"),className:"px-4 py-2 bg-yellow-400 text-black rounded hover:bg-yellow-500 transition-colors",children:"회원가입"})]})}),(0,r.jsx)("button",{onClick:()=>x(!m),className:"md:hidden text-gray-300 hover:text-yellow-400 transition-colors",children:m?(0,r.jsx)(d.Z,{size:24}):(0,r.jsx)(u.Z,{size:24})})]}),m&&(0,r.jsx)("div",{className:"md:hidden border-t border-yellow-500/20",children:(0,r.jsxs)("nav",{className:"py-4 space-y-2",children:[S.map(e=>(0,r.jsx)("a",{href:e.href,className:"block px-4 py-2 font-medium transition-colors ".concat(n===e.id?"text-yellow-400":"text-gray-300 hover:text-yellow-400"),onClick:()=>x(!1),children:e.label},e.id)),(0,r.jsx)("div",{className:"px-4 pt-4 space-y-2",children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"text-sm text-gray-400 mb-2",children:[(null==N?void 0:N.name)||(null===(l=j.email)||void 0===l?void 0:l.split("@")[0])||"사용자"," (",(null==N?void 0:N.role)==="admin"?"관리자":"일반회원",")"]}),(0,r.jsx)("button",{onClick:()=>{w.push("/mypage"),x(!1)},className:"block w-full px-4 py-2 text-left text-gray-300 hover:text-yellow-400 transition-colors",children:"마이페이지"}),(0,r.jsx)("button",{onClick:()=>{handleSignOut(),x(!1)},className:"block w-full px-4 py-2 text-left text-gray-300 hover:text-red-400 transition-colors",children:"로그아웃"})]}):(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("button",{onClick:()=>{handleAuthClick("signin"),x(!1)},className:"block w-full px-4 py-2 text-yellow-400 border border-yellow-400 rounded hover:bg-yellow-400 hover:text-black transition-colors text-center",children:"로그인"}),(0,r.jsx)("button",{onClick:()=>{handleAuthClick("signup"),x(!1)},className:"block w-full px-4 py-2 bg-yellow-400 text-black rounded hover:bg-yellow-500 transition-colors text-center",children:"회원가입"})]})})]})})]}),(0,r.jsx)(AuthModal,{isOpen:b,onClose:()=>y(!1),initialMode:f})]})}},5093:function(e,t,l){l.r(t),l.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var r=l(7437),s=l(2265),a=l(2899),n=l(4033);let i=(0,s.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[l,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[u,h]=(0,s.useState)(!0),m=(0,n.useRouter)(),fetchUserProfile=async e=>{let{data:t,error:l}=await a.OQ.from("profiles").select("*").eq("id",e).single();t&&d(t)};(0,s.useEffect)(()=>{a.OQ.auth.getSession().then(e=>{var t;let{data:{session:l}}=e;o(null!==(t=null==l?void 0:l.user)&&void 0!==t?t:null),(null==l?void 0:l.user)&&fetchUserProfile(l.user.id),h(!1)});let{data:{subscription:e}}=a.OQ.auth.onAuthStateChange(async(e,t)=>{var l;o(null!==(l=null==t?void 0:t.user)&&void 0!==l?l:null),(null==t?void 0:t.user)?await fetchUserProfile(t.user.id):d(null)});return()=>e.unsubscribe()},[]);let signIn=async(e,t)=>{let{data:l,error:r}=await a.OQ.auth.signInWithPassword({email:e,password:t});return l.user&&await fetchUserProfile(l.user.id),{error:r}},signUp=async(e,t,l)=>{let{data:r,error:s}=await a.OQ.auth.signUp({email:e,password:t,options:{data:l}});if(r.user&&!s){let{error:t}=await a.OQ.from("profiles").insert({id:r.user.id,email:r.user.email,name:(null==l?void 0:l.name)||e.split("@")[0],phone:(null==l?void 0:l.phone)||"",role:"user",created_at:new Date().toISOString()});t&&console.error("프로필 생성 오류:",t)}return{error:s}},signOut=async()=>{await a.OQ.auth.signOut(),d(null),m.push("/")},x=(null==c?void 0:c.role)==="admin";return(0,r.jsx)(i.Provider,{value:{user:l,userProfile:c,loading:u,signIn,signUp,signOut,isAdmin:x},children:t})}let useAuth=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2899:function(e,t,l){l.d(t,{OQ:function(){return s}});var r=l(1492);let s=(0,r.eI)("https://wpzvocfgfwvsxmpckdnu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndwenZvY2ZnZnd2c3htcGNrZG51Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2Njc4NTIsImV4cCI6MjA2ODI0Mzg1Mn0.LlO3iM55sbzXexcCExkDsSH448J2Z-NJUT1aZQCdck8")}}]);